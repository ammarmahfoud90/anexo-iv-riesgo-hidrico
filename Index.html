<!DOCTYPE html>
<html>
<head>
  <title>Resolución 303/17 – Anexo IV</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    /* ——— mapa ——— */
    #map { height: 100vh; position: relative; }

    /* ——— título ——— */
    .title{
      position:absolute;
      top:10px; left:50%; transform:translateX(-50%);
      background:rgba(255,255,255,.9);
      padding:8px 16px;
      font:18px Arial,sans-serif;
      font-weight:bold;
      border-radius:8px;
      box-shadow:0 0 10px rgba(0,0,0,.3);
      z-index:1000;
      max-width:90%;
      text-align:center;
    }

    /* ——— cuadros (leyenda / resumen) ——— */
    .legend,.summary{
      background:#fff;
      line-height:1.8;
      padding:10px 14px;
      font:14px Arial,sans-serif;
      box-shadow:0 0 15px rgba(0,0,0,.2);
      border-radius:5px;
      max-width:300px;
    }

    .legend-title,.summary-title{ font-weight:bold; margin-bottom:6px; }
    .legend-item{ display:flex; align-items:center; margin-bottom:4px; }
    .legend-color{
      width:18px; height:18px;
      margin-right:8px; border:1px solid #ccc; opacity:.8;
    }

    /* ——— vista móvil (≤ 600 px) ——— */
    @media (max-width:600px){
      .title{
        font-size:14px; line-height:1.25;
        padding:6px 10px; max-width:85%;
        white-space:normal; word-wrap:break-word;
      }
      .legend,.summary{
        font-size:12px; padding:8px 10px; max-width:90%;
      }
    }
  </style>
</head>
<body>
<div id="map">
  <div class="title">
    Resolución 303/17 – Anexo IV:<br>
    Valle de Inundación Ríos Paraguay y Paraná
  </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  /* ——— configurar mapa ——— */
  const map = L.map('map').setView([-27.45, -58.98], 8);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom:19,
    attribution:'© OpenStreetMap'
  }).addTo(map);

  /* ——— colores por riesgo ——— */
  function getColor(r){
    if(r==='Zona Prohibida')      return '#061351';
    if(r==='Restricción Severa')  return '#7b8f65';
    if(r==='Restricción Leve')    return '#c0dcb6';
    return '#ccc';
  }

  /* ——— estilo de cada polígono ——— */
  function style(feat){
    return{
      fillColor:getColor(feat.properties.RIESGO),
      fillOpacity:.7,
      color:'#fff',
      weight:2,
      dashArray:'3'
    };
  }

  /* ——— popup simple ——— */
  function onEach(feat,layer){
    if(feat.properties && feat.properties.RIESGO){
      layer.bindPopup('Riesgo: '+feat.properties.RIESGO);
    }
  }

  /* ——— cargar GeoJSON ——— */
  fetch('RES_PARANA.geojson')
    .then(r=>r.json())
    .then(data=>{
      L.geoJSON(data,{style:onStyle=style,onEachFeature:onEach}).addTo(map);
    });

  /* ——— leyenda ——— */
  const legend = L.control({position:'bottomright'});
  legend.onAdd = function(){
    const div = L.DomUtil.create('div','legend');
    div.innerHTML  = '<div class="legend-title">Zonificación de Riesgo</div>';
    div.innerHTML += '<div class="legend-item"><div class="legend-color" style="background:#061351"></div>Zona Prohibida</div>';
    div.innerHTML += '<div class="legend-item"><div class="legend-color" style="background:#7b8f65"></div>Restricción Severa</div>';
    div.innerHTML += '<div class="legend-item"><div class="legend-color" style="background:#c0dcb6"></div>Restricción Leve</div>';
    return div;
  };
  legend.addTo(map);

  /* ——— áreas totales ——— */
  const summary = L.control({position:'topleft'});
  summary.onAdd = function(){
    const div = L.DomUtil.create('div','summary');
    div.innerHTML  = '<div class="summary-title">Áreas Totales</div>';
    div.innerHTML += '<div>Zona Prohibida: 45412 ha</div>';
    div.innerHTML += '<div>Restricción Severa: 142228 ha</div>';
    div.innerHTML += '<div>Restricción Leve: 1091534 ha</div>';
    return div;
  };
  summary.addTo(map);
</script>
</body>
</html>
