<!DOCTYPE html>
<html>
<head>
  <title>Resolución 303/17 – Anexo IV</title>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

  <style>
    /* ——— MAPA ——— */
    #map{height:100vh;position:relative;}

    /* ——— TÍTULO ——— */
    .title{
      position:absolute;top:10px;left:50%;transform:translateX(-50%);
      background:rgba(255,255,255,.93);
      padding:8px 16px;
      font:18px/1.3 Arial,sans-serif;font-weight:bold;
      border-radius:8px;box-shadow:0 0 10px rgba(0,0,0,.3);
      z-index:1000;max-width:90%;text-align:center;
    }

    /* ——— CUADROS (leyenda / resumen) ——— */
    .box{
      background:#fff;line-height:1.6;font:14px Arial,sans-serif;
      padding:10px 14px;border-radius:5px;
      box-shadow:0 0 12px rgba(0,0,0,.18);max-width:300px;
    }
    .box h4{margin:0 0 6px 0;font-size:15px;}
    .legend-item{display:flex;align-items:center;margin-bottom:4px;}
    .legend-color{
      width:18px;height:18px;margin-right:6px;border:1px solid #ccc;opacity:.8;
    }

    /* ——— AJUSTES PARA MÓVIL (≤600 px) ——— */
    @media(max-width:600px){
      .title{
        font-size:15px;line-height:1.25;
        padding:6px 10px;max-width:85%;
        white-space:normal;word-wrap:break-word;
      }
      .box{font-size:12px;padding:8px 10px;max-width:88%;}
    }

    /* ——— MARGEN PARA RESUMEN ABAJO ——— */
    .leaflet-bottom.leaflet-left .box{
      margin-bottom:60px;
    }
  </style>
</head>

<body>
<div id="map">
  <div class="title">
    Resolución 303/17 – Anexo IV<br>
    Valle de Inundación Ríos Paraguay y Paraná
  </div>
</div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  /* ——— MAPA BASE ——— */
  const map = L.map('map').setView([-27.45, -58.98], 8);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
    maxZoom:19,attribution:'© OpenStreetMap'}).addTo(map);

  /* ——— COLOR SEGÚN RIESGO ——— */
  const getColor = r => {
    if(r==='Zona Prohibida')     return '#061351';
    if(r==='Restricción Severa') return '#7b8f65';
    if(r==='Restricción Leve')   return '#c0dcb6';
    return '#ccc';
  };

  /* ——— ESTILO ——— */
  const style = feat => ({
    fillColor   : getColor(feat.properties.RIESGO),
    fillOpacity : 0.7,
    color       : '#fff',
    weight      : 2,
    dashArray   : '3'
  });

  /* ——— POP-UP SIMPLE ——— */
  const onEach = (f,l) => {
    const r = f.properties?.RIESGO || 'Sin dato';
    l.bindPopup('Riesgo: ' + r);
  };

  /* ——— CARGAR GEOJSON ——— */
  fetch('RES_PARANA.geojson')
    .then(r => r.json())
    .then(data => L.geoJSON(data,{style,onEachFeature:onEach}).addTo(map));

  /* ——— LEYENDA ——— */
  const legend = L.control({position:'bottomright'});
  legend.onAdd = () => {
    const div = L.DomUtil.create('div','box');
    div.innerHTML =
      '<h4>Zonificación de Riesgo</h4>'+  
      '<div class="legend-item"><div class="legend-color" style="background:#061351"></div>Zona Prohibida</div>'+  
      '<div class="legend-item"><div class="legend-color" style="background:#7b8f65"></div>Restricción Severa</div>'+  
      '<div class="legend-item"><div class="legend-color" style="background:#c0dcb6"></div>Restricción Leve</div>';
    return div;
  };
  legend.addTo(map);

  /* ——— RESUMEN DE ÁREAS ——— */
  const summary = L.control({position:'bottomleft'});
  summary.onAdd = () => {
    const div = L.DomUtil.create('div','box');
    div.innerHTML =
      '<h4>Áreas Totales</h4>'+  
      'Zona Prohibida: 45412 ha<br>'+  
      'Restricción Severa: 142228 ha<br>'+  
      'Restricción Leve: 1091534 ha';
    return div;
  };
  summary.addTo(map);
</script>
</body>
</html>